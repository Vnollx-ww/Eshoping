<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VNOLLX商城</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: #f4f4f4;
        }

        /* 顶部导航栏样式 */
        header {
            background: linear-gradient(to right, #ffffff, #b3d9ff);  /* 渐变的背景从白色到深蓝 */
            padding: 15px 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);  /* 为导航栏添加阴影 */
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-left, .nav-right {
            display: flex;
            align-items: center;
        }

        .nav-left li {
            margin-right: 20px;
        }

        .nav-left a {
            color: white;
            text-decoration: none;
            font-size: 16px;
            font-weight: bold;
            position: relative;
        }

        .nav-left a:hover {
            text-decoration: underline;
        }

        .nav-center {
            flex-grow: 1;
            text-align: center;
            color: white;
            font-size: 16px;
            font-weight: normal;
            margin-left: -150px;  /* 向左移动一些 */
        }

        /* 用户头像样式 */
        .nav-right img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;  /* 头像周围添加白色边框 */
            transition: transform 0.3s ease;
        }

        .nav-right img:hover {
            transform: scale(1.1);  /* 头像悬停时放大效果 */
        }

        /* 商品列表样式 */
        #productlist {
            display: grid;
            grid-template-columns: repeat(4, 1fr);  /* 每行4个商品 */
            gap: 20px;
            padding: 30px 20px;
            background: linear-gradient(to bottom, #f9f9f9, #e0f7fa);  /* 从浅灰到淡蓝的渐变背景 */
        }

        @media (max-width: 1200px) {
            #productlist {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            #productlist {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            #productlist {
                grid-template-columns: 1fr;
            }
        }

        .product {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);  /* 增加阴影效果 */
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .product:hover {
            transform: translateY(-10px);  /* 悬停时商品卡片浮动 */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);  /* 增强悬停效果 */
        }

        .product-img {
            width: 100%;
            height: 200px;
            background-color: #ecf0f1;
            margin-bottom: 15px;
            background-size: cover;
            background-position: center;
            border-radius: 8px;
        }

        .product-info {
            padding: 10px;
        }

        .product-name {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }

        .product-price {
            font-size: 16px;
            color: #e60012;
            font-weight: bold;
        }
    </style>
</head>
<body>
<!-- 顶部导航栏 -->
<header>
    <nav class="navbar">
        <ul class="nav-left">
            <li><a href="homepage" style="color: #007BFF">首页</a></li>
            <li><a href="friends" style="color: #007BFF">好友</a></li>
        </ul>

        <div class="nav-center">
            <span style="color: black">欢迎来到 VNOLLX 商城购物系统</span>
        </div>

        <div class="nav-right">
            <img src="https://via.placeholder.com/40" alt="User Avatar" id="user-avatar">
        </div>
    </nav>
</header>

<main>
    <div id="productlist"></div>  <!-- 商品列表容器 -->
</main>

<script>
    window.onload = function() {
        const objectname = localStorage.getItem('objectname');
        if (objectname) {
            const userAvatarPath = "http://localhost:9000/eshoping/" + "UserId=" + objectname + ".jpg";
            // 如果 localStorage 中有存储头像路径，则更新头像图片的 src 属性
            document.getElementById('user-avatar').src = userAvatarPath;
        }
        loadProductList();  // 页面加载时自动调用商品加载函数
    };

    document.getElementById('user-avatar').addEventListener('click', function() {
        window.location.href = "userinfo";
    });

    // 加载商品列表的函数
    async function loadProductList() {
        try {
            const response = await fetch("/product/getproductlistinfo", {
                method: 'GET',
            });

            const data = await response.json();
            const div = document.getElementById("productlist");

            if (response.ok) {
                div.innerHTML = '';  // 清空当前显示的商品列表
                if (Array.isArray(data.productlist) && data.productlist.length > 0) {
                    data.productlist.forEach(product => {
                        const productDiv = document.createElement("div");
                        productDiv.classList.add("product");

                        // 商品图片
                        const productImageDiv = document.createElement("div");
                        productImageDiv.classList.add("product-img");
                        productImageDiv.style.backgroundImage = `url("http://127.0.0.1:9000/eshoping/UserId=3.jpg")`;

                        // 商品信息
                        const productInfoDiv = document.createElement("div");
                        productInfoDiv.classList.add("product-info");

                        // 商品名称
                        const productName = document.createElement("div");
                        productName.classList.add("product-name");
                        productName.textContent = product.name;

                        // 商品价格
                        const productPrice = document.createElement("div");
                        productPrice.classList.add("product-price");
                        productPrice.textContent = `￥${product.price}`;

                        // 将商品名和价格添加到商品信息区域
                        productInfoDiv.appendChild(productName);
                        productInfoDiv.appendChild(productPrice);

                        // 将图片和信息加入商品容器
                        productDiv.appendChild(productImageDiv);
                        productDiv.appendChild(productInfoDiv);

                        // 商品点击事件，跳转到购买界面
                        productDiv.addEventListener('click', function () {
                            window.location.href = `productDetail.html?id=${product.id}`;
                        });

                        // 将商品容器添加到商品列表
                        div.appendChild(productDiv);
                    });
                } else {
                    div.innerHTML = "没有找到任何商品。";
                }
            } else {
                div.innerHTML = "加载商品列表失败。";
            }
        } catch (error) {
            console.error("加载商品列表失败:", error);
        }
    }
</script>
</body>
</html>